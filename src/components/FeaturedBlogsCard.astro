---
import Link from '@/components/Link.astro'
import { getRecentPosts } from '@/lib/data-utils'
import { Icon } from 'astro-icon/components'

const recentPosts = await getRecentPosts(1)
const featuredPost = recentPosts[0]
---

<div
  class="bg-card text-card-foreground group flex h-full flex-col overflow-hidden rounded-lg border transition-all duration-300 hover:shadow-lg"
>
  {
    featuredPost ? (
      <Link href={`/blog/${featuredPost.id}`} class="flex h-full flex-col">
        {/* Blog Image */}
        <div class="bg-muted relative h-32 overflow-hidden">
          {featuredPost.data.image && (
            <img
              src={featuredPost.data.image.src}
              alt={featuredPost.data.title}
              class="h-full w-full object-cover transition-transform duration-300 group-hover:scale-105"
            />
          )}
          <div class="absolute inset-0 bg-black/10 transition-colors duration-300 group-hover:bg-black/20" />
        </div>

        {/* Content */}
        <div class="flex flex-1 flex-col justify-between p-6">
          <div class="space-y-3">
            <div>
              <h3 class="text-foreground group-hover:text-primary line-clamp-2 text-lg font-semibold transition-colors">
                {featuredPost.data.title}
              </h3>
              <p class="text-muted-foreground mt-2 line-clamp-2 text-sm">
                {featuredPost.data.description}
              </p>
            </div>

            {/* Tags */}
            {featuredPost.data.tags && featuredPost.data.tags.length > 0 && (
              <div class="flex flex-wrap gap-1">
                {featuredPost.data.tags.slice(0, 2).map((tag) => (
                  <span class="bg-muted text-muted-foreground rounded-md px-2 py-1 text-xs">
                    {tag}
                  </span>
                ))}
              </div>
            )}
          </div>

          {/* Read More */}
          <div class="mt-4 flex items-center justify-between">
            <span class="text-primary text-sm font-medium">Read more</span>
            <Icon
              name="lucide:arrow-right"
              class="text-primary size-4 transition-transform group-hover:translate-x-1"
            />
          </div>
        </div>
      </Link>
    ) : (
      <div class="flex h-full items-center justify-center p-6">
        <div class="space-y-2 text-center">
          <h3 class="text-muted-foreground text-lg font-semibold">
            No Posts Yet
          </h3>
          <p class="text-muted-foreground text-sm">
            Check back later for new content!
          </p>
        </div>
      </div>
    )
  }
</div>
